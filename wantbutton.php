<?php
/*
Plugin Name: Wordpress WANT Button
Plugin URI: http://wantbutton.com
Description: This provides publishers and users to add a WANT button to the end of their posts.  The product information can be filled in on the post and edit pages.
Version: 1.1.2
Author: gjagasia
Author URI: http://wantbutton.com
License: Want
*/

/*
Terms Of Service Agreement
Welcome to “Want”®. We offer you the code, graphics and documentation that will give you and your users access to the "Want"® selection button and the related reporting and marketing tools offered by us, Want Technologies.
The “Want”® selection button helps merchants socialize the buying experience by allowing their consumers to share "Want"® selections via social network media, including FaceBook. The "Want"® selection button also allows consumers to manage their "Want"® selections on Facebook.
The "Want"® selection button is made available for your use provided that you agree to and abide by the following terms. BY DOWNLOADING THE "WANT"® SELECTION BUTTON LOGO AND/OR UTILIZING THE "WANT"® SELECTION BUTTON ON YOUR WEBSITE, YOU SIGNIFY ELECTRONICALLY YOUR AGREEMENT TO THESE TERMS OF SERVICE ("Terms" or "Agreement"). You may not use the "Want"® selection button if you do not agree.

Terms
These Terms serve as an agreement between you and us, which you are accepting electronically online, and which govern your use of the "Want"® selection button. We use the term "you" to mean you as an individual or entity and "we" or "us" to mean Want Technologies which is the entity that provides the "Want"® selection button and related services. You agree that we may provide you with important information and terms electronically, either by posting such notices online or via email. Use of tools and data associated with the "Want"® selection button services does not entitle you to ownership of any intellectual property rights. All intellectual property rights (including but not limited to copyrights, trademarks, trade secrets, know-how or other intellectual property) shall remain at all times the property of Want Technologies.

Changes to Terms
These Terms may change from time to time. By continuing to use the "Want"® selection button after we post changes to this Agreement, you accept the Terms as modified. We may modify these terms at any time. It is your responsibility to review the terms regularly. Changes will be effective no later than seven days after they are posted. However, changes made addressing functionality or changes made for legal reasons will be effective immediately. If you do not agree to the modified terms for the "Want"® service, you must notify us in writing immediately upon your awareness and you must also immediately discontinue your use of the "Want"® selection button.

Requirements
The "Want"® selection button is available only to (a) individuals who are legally capable of entering into contracts and (b) corporations and other organizations that can form legally binding contracts under applicable law. If you are not eligible, you may not sign up or use the "Want"® selection button. We reserve the right to remove or refuse the "Want"® services, for any reason, without notice and with no liability to you. We also reserve the right to change our criteria for eligibility, at any time, in our sole discretion.

Your obligations
You may not use the "Want"® selection button in any manner that violates any applicable federal, state, or local law, or the proprietary or contractual rights of others. You are solely responsible for all resources needed to develop and operate your site and for all materials that appear on the site. You must back up at your own expense any data and files that you desire to keep. You must also comply with all of the terms herein, including the below Usage Guidelines.
You are also responsible to deploy new versions of the "Want"® selection button as they become available.

Your rights to use the "Want" Selection Button
We offer you the following rights to use the "Want"® selection button provided that you continue to comply with the terms of this Agreement. Your right to display the "Want"® selection button carries with it a non-exclusive and non-transferrable license under the intellectual property rights of CVG-SAB, LLC (including rights in the WANT registered trademark), which is limited only to your web site (the "Site") and not in connection with any application such as a toolbar, plug-in, helper, and component or other software that runs on an end user's computer. The "Want"® selection button may not be modified from the format as specified in the Usage Guidelines, including the size of the selection button, the type of font used in association with the selection button, or any other graphic detail on the selection button. You may not remove, distort or alter any element of the "Want"® selection button (including the HTML and JavaScript code). You may not decompile or reverse engineer any code associated with the operation or functionality of the "Want"® selection button. You may not use the "Want"® selection button in any manner that implies that you are affiliated with or endorsed by us. You may not transfer these rights to anyone else. You may access the "Want"® selection button only through the software, interfaces and protocols provided or authorized by us. You agree that any intellectual property rights discussed herein are valid and you agree not to challenge the validity of any such intellectual property rights.

Usage Guidelines
You may use the "Want"® selection button in association with your product as follows:
You may tell people to click on the "Want"® selection button to show their preference to your product whether on your website (or wherever your product is available) next to that product (see icon below) or using the full term ‘the "Want"® selection button’;
Do not use the "Want"® selection button as a hyperlink in advertising on third party websites, use only in conjunction with the authorized outlet;
When referencing the "Want"® selection button in non-internet media such as traditional print advertising, it must be presented as the "Want"® selection button, or by use of the icon, with permission and without any hyperlink;
When using the "Want"® selection button in traditional non electronic media, such as in printed advertising, you must attribute the "Want"® selection button to us;
You must add a disclaimer to your site stating that: "Want"® does not endorse, support or represent your particular product/item/merchant and "Want"® has no affiliation with any one particular product/item/merchant unless specified;
In referring to the "Want"® selection button, it should include the ® symbol and acknowledge that the designation “Want” is a registered trademark;
You may only use the "Want"® selection button according to the following design, only altering the size as appropriate; 
No deceptive, obscene or otherwise harmful uses of the "Want"® selection button icon or "Want"® will be tolerated and discovery by us of any such use will lead to immediate termination of services.
No use associated with pornography, gambling or other illicit activities;
Want Technologies reserves the right to make any judgment and terminate services if they determine activities qualify as illicit.
No license under any of our intellectual property rights shall extend to any use of the "Want"® selection button that is not in accordance with the above usage guidelines.

Our Ownership rights
You acknowledge that the "Want"® selection button is owned by us. The "Want"® selection button is protected by intellectual property laws. We reserve all rights not specifically granted to you. You may not reverse engineer, decompile, or disassemble any aspect of the "Want"® selection button. You may not modify, adapt, or create derivative works from the "Want"® selection button or remove proprietary notices. Use of services associated with the "Want"® logo and trademark does not entitle you to ownership of any of our intellectual property rights. All such rights shall remain at all times our property. Any deviation of that use will be in direct violation of these terms and conditions and subject to cancellation of our services. "Want"® is not associated with or otherwise affiliated with Facebook. You acknowledge that the Want® selection button, associated logos, and the designation “Want” are valid trademarks that belong to us.

End User Information
We will retain custody of all data and information collected or obtained by us from users of the "Want"® selection button.
All data is handled according to our end user privacy policy found here http://wanttt.com/w/legal/ and shown below.

Sharing
Want Technologies or its affiliates will never rent, sell, or share your email, physical address or other personal information to a third party, except in the following circumstances:
We may share your email with affiliated companies or other trusted third-party partners for the purpose of providing the end user with a more efficient and customized experience. We require that these parties agree to process such information based upon our instructions and in compliance with this policy and any other appropriate confidentiality and security measures.
We may share certain contact information with PayPal during the Want® sign up to pre-fill a PayPal account.
We may share information with “Want”® merchants to provide targeted marketing messages and services.
We believe it is necessary to share information in order to investigate, prevent, or take action regarding illegal activities, suspected fraud, situations involving potential threats to the physical safety of any person, violations of Want® Terms of Service, or as otherwise required by law.
If Want Technologies becomes involved in a merger, acquisition, or any form of sale of some or all of its assets, we will provide notice before personal information is transferred and becomes subject to a different privacy policy.

Notifications
End users are able to unsubscribe from Want® or any other merchant promotional emails by clicking unsubscribe in the respected email footer.
End users are able to make changes to certain email notifications under My Account

Disclaimers and Limitations of Liability
Access to and use of the “WANT”® selection button are at your own risk. Services related to the “WANT”® selection button are provided to you on an “AS IS” and “AS AVAILABLE” basis. We disclaim all warranties and conditions whether express or implied, of merchantability, fitness for a particular purpose or non-infringement. We make no warranty and disclaim all responsibility and liability for: (i) the accuracy, availability, timeliness, security or reliability of the services; (ii) any harm to your computer system, loss of data, or other harm that results from your access to or use of “WANT”® selection button; (iii) the deletion of or failure to store or transmit information; and (iv) whether the “WANT”® selection button will meet your requirements or be available on an uninterrupted, secure, or error-free basis. No information obtained, whether oral or written, from Want Technologies will create any warranty.
When permitted by law, Want Technologies will not be liable for any indirect, incidental, special, exemplary, consequential or punitive damages, or any loss of profits, revenues, or data, financial losses, goodwill, or any other intangible losses resulting from your use or inability to use the “WANT”® selection button.
The laws of the state of Michigan will apply to any disputes arising out of or relating to these terms or the use of the “WANT”® selection button. All claims arising out of or relating to these terms or the use of the “WANT”® selection button will be litigated exclusively in the federal or state courts of Michigan, and you consent to personal jurisdiction in those courts.
*/


$function_names_used = array('want_button_script', 'register_jquery', 'error_check_js', 'get_want_button',
							'append_want_button_bottom','want_button_box','want_button_box_save','want_button_box_content',
							'check_version');
$error_items = '';
$wb_options = get_option('wb_options');

// Set of hooks that operate the plugin.

register_activation_hook(WP_PLUGIN_DIR . '/want-wordpress/wantbutton.php', 'check_version' );
add_action('save_post', 'want_button_box_save' );
add_action('wp_head', 'want_button_script');
add_action('admin_init', 'register_jquery');
add_action('admin_init', 'want_button_box' );
add_action( 'admin_menu', 'wb_menu_options' );
add_action('admin_init', 'wb_register_settings');


function some_unique_function_name_cannot_load()
{
      global $error_items;
      print '<div class="error"><p><strong>'
      . __('The "Wordpress WANT Button" plugin cannot load correctly')
      . '</strong> '
      . __('Another plugin has declared conflicting class, function, or
   			constant names:')
      . "<ul'>$error_items</ul>"
      . '</p><p>'
      . __  ('You must deactivate the plugins that are using these
   			conflicting names.')
      . '</p></div>';
}

function check_version() {
	global $wp_version;
	if (version_compare($wp_version, '3.0', '<')) {
	exit("This plugin requires WordPress 3.0 or greater.");
	}
	else {

	//Setup default options for values
    // defaults are to:
    // display on every page
	// style is wb1
	// appears on the lower left

	if ( !isset( $wb_options['display_every_page'] ) ) { $wb_options['display_every_page'] = 'true'; }
	if ( !isset( $wb_options['alignment'] ) ) { $wb_options['alignment'] = 'lower_left'; }
	if ( !isset( $wb_options['button_style'] ) ) { $wb_options['button_style'] = 'wb1'; }
    
	//Save default option values
	update_option( 'wb_options', $wb_options );
	}
}

// This actually puts wb_options into the database.

function wb_register_settings() {
	register_setting( 'wb_settings_group', 'wb_options' );
}

// This is static WANT button javascript.  This shouldn't be changed, if you intend for the button to continue working.

function want_button_script()
{
	echo '<script>
			(function() {
			        var _w = document.createElement("script"); _w.type = "text/javascript"; _w.async = true;
			        _w.src = "http://button.wanttt.com/button/script/";
			        var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(_w, s);
			})();
			</script>';
}

// Make sure we have access to jquery in the admin panel.

function register_jquery() {
    wp_deregister_script( 'jQuery' );
    wp_register_script( 'jQuery', 'http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js');
    wp_enqueue_script( 'jQuery' );
}

// This takes in the parameters and builds the WANT button for posting, based on the post meta data box.

function get_want_button( ){
	global $post;
	global $wb_options;
	$postID = $post->ID;

	$wb_product_url = get_post_meta( $postID, 'wb_product_url', true);
	$wb_product_name = get_post_meta( $postID, 'wb_product_name', true);
	if ($wb_product_name == '') {
		$wb_product_name = $post->post_title;
	}
	$wb_product_price = get_post_meta( $postID, 'wb_product_price', true);
	$wb_merchant_name = get_post_meta( $postID, 'wb_merchant_name', true);
	if ($wb_merchant_name == '') {
		$wb_merchant_name = get_bloginfo();
	}
	$wb_image_url = get_post_meta( $postID, 'wb_image_url', true);
	$wb_enable_toggle = get_post_meta( $postID, 'wb_enable_toggle', true);
	$current_button_style = $wb_options['button_style'];
	$alignment = $wb_options['alignment'];
	if ($alignment == "lower_left" || $alignment == "upper_left") {
		$htmlalign = "float:left;";
	}
	elseif ($alignment == "lower_center" || $alignment == "upper_center") {
		$htmlalign = "margin-left: 40%; margin-right:50%;";
	}
	elseif ($alignment == "lower_right" || $alignment == "upper_right") {
		$htmlalign = "float:right;";
	}
	else {
		// Just in case catchall.
		$htmlalign = "float:left;";
	}

	// Originally, in some test code, if a publisher had decided to disable the WANT Button, then
	// it would just append this Gangnam Style gif to the end of the post.  This is very unprofessional
	// but I thought it might be entertaining for someone who actually wanted to read the code.  
	// That song is toxic.
	//   -Gandhi
	// http://25.media.tumblr.com/tumblr_m879e8m2AF1rwq9q8o1_500.gif	

	if ( $wb_enable_toggle == 'on') {
	$wantbutton =   '<div style="' . $htmlalign . '"><a href="http://wanttt.com/want/initial_popup/" 
					data-return_url="' . $wb_product_url . '" 
					data-merchant_name="' . $wb_merchant_name . '" 
					data-title="' . $wb_product_name . '" 
					data-price="' . $wb_product_price . '" 
					data-image_url="' . $wb_image_url . '"
					data-count="true" data-style="'. $current_button_style . '" data-page_source="WPPLUGIN" class="wantButton"></a></div>';		
	}
	elseif ( $wb_enable_toggle == 'off' ) {
		$wantbutton = '';
	}

	elseif ($wb_options['display_every_page'] == 'true' && empty ( $wb_enable_toggle ) == true) {
	$wantbutton =   '<div style="' . $htmlalign . '"><a href="http://wanttt.com/want/initial_popup/" 
					data-return_url="' . $wb_product_url . '" 
					data-merchant_name="' . $wb_merchant_name . '" 
					data-title="' . $wb_product_name . '" 
					data-price="' . $wb_product_price . '" 
					data-image_url="' . $wb_image_url . '"
					data-count="true" data-style="'. $current_button_style . '" data-page_source="WPPLUGIN" class="wantButton"></a></div>';		
	}
	else { 
		$wantbutton = '';
	}
		return $wantbutton;
	}

// Updated!
// Now the user has an option in the settings to assign an alignment of the WANT button to:
// "upper_left", "upper_center", "upper_right", "lower_left", "lower_center" or "lower_right" of the post.

if( !function_exists("append_want_button_bottom")){
	function append_want_button_bottom($content){
		global $wb_options;

		if( !is_page( )){
			$wantbutton = get_want_button();

			if ($wb_options['alignment'] == "upper_left" || $wb_options['alignment'] == "upper_center" || $wb_options['alignment'] == "upper_right") {
				return $wantbutton . $content;
			}
			else {
				return $content . $wantbutton;				
			}
		} else {
			return $content;
		}
	}

	/*	add our filter function to the hook */

	add_filter('the_content', 'append_want_button_bottom');
}

// Add want meta box to the post and edit pages.

function want_button_box() {
	add_meta_box( 'want_button_box','WANT Button Settings', 'want_button_box_content', 'page', 'advanced', 'high' );
	add_meta_box( 'want_button_box','WANT Button Settings', 'want_button_box_content', 'post', 'advanced', 'high' );
}

// Add in Admin Menu

function wb_menu_options() {
	$capability = 'manage_options';

	$page = add_menu_page( 'WANT Button Settings', 'WANT Button', $capability, __FILE__, 'wb_settings_page', plugins_url( '/img/wb-logo-small.gif', __FILE__));

}

// Style the want button meta box for the post and edit pages.  There's a little more ehre than last time to make sure the right options are on, universally and not.

function want_button_box_content( $post ) {

	global $wb_options;

	$wb_merchant_name = get_post_meta( $post->ID, 'wb_merchant_name', true);
	$wb_product_url = get_post_meta( $post->ID, 'wb_product_url', true);
	$wb_product_name = get_post_meta( $post->ID, 'wb_product_name', true);
	$wb_product_price = get_post_meta( $post->ID, 'wb_product_price', true);
	$wb_image_url = get_post_meta( $post->ID, 'wb_image_url', true);
	$wb_enable_toggle = get_post_meta( $post->ID, 'wb_enable_toggle', true);


	if ($wb_options['display_every_page'] == 'true' && $wb_enable_toggle != 'off' || $wb_options['display_every_page'] == 'true' && empty ($wb_enable_toggle) == true){
		$checked = 'true';
	}
	elseif ($wb_enable_toggle == 'off') {
	}
	?>

	<p>
	</p>
		<p>
		<input name="wb_enable_toggle" id="wb_enable_toggle" type="checkbox" value="1" <?php 
		if ($checked == 'true') {
			echo 'checked = true';
		}

		?>/>
		<label for="wb_enable_toggle">Enable WANT Button</label>
		<p class="description">
			Enable the WANT button for this page.
		</p>
	</p>

	<p>

		<table class="form-table inside">
			<tr valign="top">
				<td>
					<label for="wb_merchant_name">Name of the Merchant (if left blank, it will default to the blog name)</label><br/>
					<input type="text" id="wb_merchant_name" name="wb_merchant_name" value="<?php echo $wb_merchant_name; ?>" class="widefat"/>
				</td>
			</tr>
			<tr valign="top">
				<td>
					<label for="wb_product_url">Product Detail Page URL (if left blank it will default to the blog post URL)</label><br/>
					<input type="text" id="wb_product_url" name="wb_product_url" value="<?php echo $wb_product_url; ?>" class="widefat"/>
				</td>
			</tr>
			<tr valign="top">
				<td>
					<label for="wb_product_name">Product Name (if left blank, it will default to the post name)</label><br/>
					<input type="text" id="wb_product_name" name="wb_product_name" value="<?php echo $wb_product_name; ?>" class="widefat"/>
				</td>
			</tr>
			<tr valign="top">
				<td>
					<label for="wb_product_price">Price (if left blank it will default to N/A)</label><br/>
					<input type="text" id="wb_product_price" name="wb_product_price" value="<?php echo $wb_product_price; ?>" class="widefat"/>
				</td>
			</tr>
			<tr valign="top">
				<td>
					<label for="wb_image_url">High Resolution Product Image URL (if left blank, it will use our image-picker)</label><br/>
					<input type="text" id="wb_image_url" name="wb_image_url" value="<?php echo $wb_image_url; ?>" class="widefat"/>
				</td>
			</tr>
		</table>
	</p>		
		
	<?php	
}

// Actually save the post meta data on the edit and post pages.
// This got simplified a little, because we have a huge leniency built into the button now - if you decide to have 0 parameters, it'll work.

function want_button_box_save( $post_id ) {
	if ( defined('DOING_AUTOSAVE') && DOING_AUTOSAVE )
		return $post_id;
	if ( isset( $_POST['post_type'] ) && ( 'post' == $_POST['post_type'] || 'page' == $_POST['post_type'] ) ) {
		if ( current_user_can( 'edit_post', $post_id ) ) {
				// I want to keep this regex just in case, and I don't feel like digging through wordpress' repo.
				// $urlregex = "^(https?|ftp)\:\/\/([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?[a-z0-9+\$_-]+(\.[a-z0-9+\$_-]+)*(\:[0-9]{2,5})?(\/([a-z0-9+\$_-]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@/&%=+\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)?\$";

				// if (eregi($urlregex, $_POST['wb_product_url'])) {
				// update_post_meta( $post_id, 'wb_product_url', $_POST['wb_product_url']);

				update_post_meta( $post_id, 'wb_product_url', $_POST['wb_product_url']);
				update_post_meta( $post_id, 'wb_merchant_name', $_POST['wb_merchant_name']);
				update_post_meta( $post_id, 'wb_product_name', $_POST['wb_product_name']);
				update_post_meta( $post_id, 'wb_product_price', $_POST['wb_product_price']);

				update_post_meta( $post_id, 'wb_image_url', $_POST['wb_image_url']);
				
				if ( ! isset( $_POST['wb_enable_toggle']) ) {
				update_post_meta( $post_id, 'wb_enable_toggle', 'off');					
				}
				else {
					update_post_meta( $post_id, 'wb_enable_toggle', 'on');
				}

		}
	}

	return $post_id;
}

// Style up the admin page.  This might be the thing I'm worst at.
// I'm a back end developer, for the most part.  Making things look pretty is hard.

function wb_settings_page() {
	global $wb_options;
	$current_button_style = $wb_options['button_style'];
	if ($current_button_style == "wbtall") {
		$demo_button_url = plugins_url( '/img/wb-button-vertical.png', __FILE__);
		$demo_box_height = 675;
	}
	elseif ($current_button_style == "wb2") {
		$demo_button_url = plugins_url( '/img/wb-button-medium.png', __FILE__);
		$demo_box_height = 600;
	}
	elseif ($current_button_style == "wb3") {
		$demo_button_url = plugins_url( '/img/wb-button-small.png', __FILE__);
		$demo_box_height = 600;
	}
	else {
		$demo_button_url = plugins_url( '/img/wb-button-large.png', __FILE__);
		$demo_box_height = 600;
	}
 
	ob_start(); ?>
	<div class="wrap">
		<h2><img src="<?php echo plugins_url( '/img/wb-logo-large.gif', __FILE__)?>">WANT Button Settings</h2>
		<form method="post" action="options.php">
			<?php settings_fields('wb_settings_group'); ?>
			<div class="postbox" style="width:500px; height:125px;">
				<h3>Globally Enable WANT Button</h3>
				<h4>If set to on, you have to disable the WANT button on pages you don't want it on.  If set to off, you have to enable the WANT button on pages you want it on.</h4>
				<input type="radio" id="display_every_page" value="true" name="wb_options[display_every_page]"
					<?php checked( ( $wb_options['display_every_page'] == 'true' ) ); ?> />
				<label for="display_every_page">Add the WANT button to every post.</label>
				<br>
				<br>
				<input type="radio" id="display_every_page" value="false" name="wb_options[display_every_page]"
					<?php checked( ( $wb_options['display_every_page'] == 'false' ) ); ?> />
				<label for="display_alignment">Default the WANT button to off, and you have to explicitly add the Want button to posts.</label>
			</div>
			<div class="postbox" style="width:500px; height:175px;">
				<h3>Button Style</h3>
				<h4>We offer 4 different styles of button, depending on your preferences.</h4>
				<ul>
					<li class="button_style" style="float:left; width:125px;">
						<input type="radio" id="button_style" value="wb1" name="wb_options[button_style]"
							<?php checked( ( $wb_options['button_style'] == 'wb1' ) || empty( $wb_options['button_style'] ) ); ?> style="margin:1px auto 1px; display:block;"/>
						<br>
						<label for="button_style"><img src="<?php echo plugins_url( '/img/wb-button-large.png', __FILE__) ?>"  style="margin:1px auto 1px; display:block;"></label>
					</li>
					<li class="button_style" style="float:left; width:125px;">
						<input type="radio" id="button_style" value="wb2" name="wb_options[button_style]"
							<?php checked( ( $wb_options['button_style'] == 'wb2' ) || empty( $wb_options['button_style'] ) ); ?> style="margin:1px auto 1px; display:block;"/>
						<br>
						<label for="button_style"><img src="<?php echo plugins_url( '/img/wb-button-medium.png', __FILE__) ?>"  style="margin:1px auto 1px; display:block;"></label>
					</li>
					<li class="button_style" style="float:left; width:125px;">
						<input type="radio" id="button_style" value="wb3" name="wb_options[button_style]"
							<?php checked( ( $wb_options['button_style'] == 'wb3' ) || empty( $wb_options['button_style'] ) ); ?> style="margin:1px auto 1px; display:block;"/>
						<br>
						<label for="button_style"><img src="<?php echo plugins_url( '/img/wb-button-small.png', __FILE__) ?>"  style="margin:1px auto 1px; display:block;"></label>
					</li>
					<li class="button_style" style="float:left; width:125px;">
						<input type="radio" id="button_style" value="wbtall" name="wb_options[button_style]"
							<?php checked( ( $wb_options['button_style'] == 'wbtall' ) || empty( $wb_options['button_style'] ) ); ?> style="margin:1px auto 1px; display:block;"/>
						<br>
						<label for="button_style"><img src="<?php echo plugins_url( '/img/wb-button-vertical.png', __FILE__) ?>"  style="margin:1px auto 1px; display:block;"></label>
					</li>
				</ul>
			</div>
			<br>
			<div class="postbox" style="width:500px; height:<?php echo $demo_box_height; ?>px;">
			<h3>Alignment of the WANT Button</h3>
			<h4>Imagine that the image here is your post.  The options include upper-left, upper-center, upper-right, lower-left, lower-center, and lower-right.  Save your preferred button style to change the preview image.</h4>			
			<ul>
				<li class="alignment" style="float:left; width:125px;">
					<input type="radio" id="upper_left" value="upper_left" name="wb_options[alignment]"
						<?php checked( ( $wb_options['alignment'] == 'upper_left' ) || empty( $wb_options['alignment'] ) ); ?> style="margin:1px auto 1px; display:block;" />
					<img src="<?php echo $demo_button_url ?>" style="margin:1px auto 1px; display:block;">
				</li>
				<li class="alignment" style="float:left; width:125px;">
					<input type="radio" id="upper_center" value="upper_center" name="wb_options[alignment]"
						<?php checked( ( $wb_options['alignment'] == 'upper_center' ) || empty( $wb_options['alignment'] ) ); ?> style="margin:1px auto 1px; display:block;" />
					<img src="<?php echo $demo_button_url ?>" style="margin:1px auto 1px; display:block;">
				</li>
				<li class="alignment" style="float:left; width:125px;">
					<input type="radio" id="upper_right" value="upper_right" name="wb_options[alignment]"
						<?php checked( ( $wb_options['alignment'] == 'upper_right' ) || empty( $wb_options['alignment'] ) ); ?> style="margin:1px auto 1px; display:block;" />
					<img src="<?php echo $demo_button_url ?>" style="margin:1px auto 1px; display:block;">
				</li>
			</ul>
			<br>
			<img src="<?php echo plugins_url( '/img/ex_post.png', __FILE__) ?>">
			<br>
			<ul>
				<li class="alignment" style="float:left; width:125px;">
					<input type="radio" id="lower_left" value="lower_left" name="wb_options[alignment]"
						<?php checked( ( $wb_options['alignment'] == 'lower_left' ) || empty( $wb_options['alignment'] ) ); ?> style="margin:1px auto 1px; display:block;" />
					<img src="<?php echo $demo_button_url ?>" style="margin:1px auto 1px; display:block;">
				</li>
				<li class="alignment" style="float:left; width:125px;">
					<input type="radio" id="lower_center" value="lower_center" name="wb_options[alignment]"
						<?php checked( ( $wb_options['alignment'] == 'lower_center' ) || empty( $wb_options['alignment'] ) ); ?> style="margin:1px auto 1px; display:block;" />
					<img src="<?php echo $demo_button_url ?>" style="margin:1px auto 1px; display:block;">
				</li>
				<li class="alignment" style="float:left; width:125px;">
					<input type="radio" id="lower_right" value="lower_right" name="wb_options[alignment]"
						<?php checked( ( $wb_options['alignment'] == 'lower_right' ) || empty( $wb_options['alignment'] ) ); ?> style="margin:1px auto 1px; display:block;" />
					<img src="<?php echo $demo_button_url ?>" style="margin:1px auto 1px; display:block;">
				</li>
			</ul>
 			</div>
 			<br>
			<p class="submit">
				<input type="submit" class="button-primary" value="<?php _e('Save Options'); ?>" />
			</p>
		</form>
	</div>
	<?php
	echo ob_get_clean();
}
?>